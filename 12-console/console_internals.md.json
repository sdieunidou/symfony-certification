{
  "source_file": "12-console/console_internals.md",
  "title": "Console : Fonctionnement Interne",
  "questions": [
    {
      "id": 1,
      "question": "Quelle méthode de la classe `Command` contient la logique principale à exécuter ?",
      "type": "single_choice",
      "options": [
        "run()",
        "configure()",
        "execute()",
        "interact()"
      ],
      "correct_answers": [
        "execute()"
      ],
      "explanation": "C'est le cœur de la commande. Elle prend `InputInterface` et `OutputInterface` en arguments."
    },
    {
      "id": 2,
      "question": "Que doit retourner la méthode `execute()` d'une commande ?",
      "type": "single_choice",
      "options": [
        "Rien (void).",
        "Un booléen (true/false).",
        "Un entier (Exit Code).",
        "Une chaîne de caractères (Output)."
      ],
      "correct_answers": [
        "Un entier (Exit Code)."
      ],
      "explanation": "Ce code est renvoyé au système d'exploitation. 0 signifie succès (`Command::SUCCESS`), tout autre chiffre signifie erreur."
    },
    {
      "id": 3,
      "question": "À quoi sert la classe `SymfonyStyle` ($io) ?",
      "type": "single_choice",
      "options": [
        "À ajouter du CSS à la console.",
        "À fournir des helpers de formatage (titres, tableaux, barres de progression) et d'interaction simplifiés.",
        "À parser les arguments.",
        "À colorer le code PHP."
      ],
      "correct_answers": [
        "À fournir des helpers de formatage (titres, tableaux, barres de progression) et d'interaction simplifiés."
      ],
      "explanation": "C'est la manière recommandée de gérer les entrées/sorties pour avoir une interface utilisateur cohérente et jolie."
    },
    {
      "id": 4,
      "question": "Quelle méthode permet de demander des informations manquantes à l'utilisateur AVANT l'exécution (mode interactif) ?",
      "type": "single_choice",
      "options": [
        "configure()",
        "initialize()",
        "interact()",
        "ask()"
      ],
      "correct_answers": [
        "interact()"
      ],
      "explanation": "Cette méthode est appelée juste avant `execute()`. Elle permet de vérifier si des arguments manquent et de lancer des questions `$io->ask()` pour remplir l'objet `$input`."
    },
    {
      "id": 5,
      "question": "Pourquoi faut-il être vigilant avec la gestion de la mémoire (Memory Leak) dans les commandes de type 'Worker' ou 'Daemon' ?",
      "type": "single_choice",
      "options": [
        "Parce que PHP a une limite de mémoire très basse.",
        "Parce que contrairement à une requête HTTP, le processus PHP ne meurt pas après chaque tâche, donc la mémoire n'est pas libérée automatiquement.",
        "Parce que la console utilise plus de mémoire que le web.",
        "Ce n'est pas un problème en PHP 8."
      ],
      "correct_answers": [
        "Parce que contrairement à une requête HTTP, le processus PHP ne meurt pas après chaque tâche, donc la mémoire n'est pas libérée automatiquement."
      ],
      "explanation": "Il faut nettoyer l'EntityManager (`$em->clear()`) et les variables cycliques pour éviter que la consommation RAM n'explose sur le long terme."
    },
    {
      "id": 6,
      "question": "Quel est l'ordre d'appel du cycle de vie lors de `run()` d'une commande ?",
      "type": "single_choice",
      "options": [
        "configure -> execute",
        "initialize -> interact -> execute",
        "interact -> initialize -> execute",
        "execute uniquement"
      ],
      "correct_answers": [
        "interact -> initialize -> execute"
      ],
      "explanation": "En mode interactif, interact précède initialize, puis vient execute."
    },
    {
      "id": 7,
      "question": "Que se passe-t-il si `execute()` ne retourne pas d'entier ?",
      "type": "single_choice",
      "options": [
        "Symfony considère SUCCESS",
        "C'est déprécié et finit par lancer une erreur : un int est requis",
        "La commande est ignorée",
        "Le code de sortie vaut -1"
      ],
      "correct_answers": [
        "C'est déprécié et finit par lancer une erreur : un int est requis"
      ],
      "explanation": "Les commandes doivent retourner un code de sortie (0/1/2...)."
    },
    {
      "id": 8,
      "question": "Quel code retourner pour une mauvaise utilisation (arguments invalides) ?",
      "type": "single_choice",
      "options": [
        "`Command::SUCCESS`",
        "`Command::FAILURE`",
        "`Command::INVALID`",
        "`Command::USAGE_ERROR`"
      ],
      "correct_answers": [
        "`Command::INVALID`"
      ],
      "explanation": "INVALID (2) signale une erreur d'usage."
    },
    {
      "id": 9,
      "question": "Pourquoi préférer l'injection par constructeur pour les dépendances ?",
      "type": "single_choice",
      "options": [
        "Pour bénéficier de l'autowiring et éviter le conteneur statique",
        "Pour cacher la commande",
        "Pour éviter l'autoconfiguration",
        "Pour empêcher le lazy loading"
      ],
      "correct_answers": [
        "Pour bénéficier de l'autowiring et éviter le conteneur statique"
      ],
      "explanation": "Améliore testabilité et respect du DI."
    },
    {
      "id": 10,
      "question": "Quel est le point d'entrée principal d'une appli console Symfony ?",
      "type": "single_choice",
      "options": [
        "`Symfony\\Component\\Console\\Application`",
        "`Kernel::boot`",
        "`Command::run`",
        "`ConsoleKernel`"
      ],
      "correct_answers": [
        "`Symfony\\Component\\Console\\Application`"
      ],
      "explanation": "Application orchestre l'enregistrement et l'exécution des commandes."
    }
  ]
}