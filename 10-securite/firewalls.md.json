{
  "source_file": "10-securite/firewalls.md",
  "title": "Firewalls (Pare-feu)",
  "questions": [
    {
      "id": 1,
      "question": "Que signifie l'option `stateless: true` dans un firewall ?",
      "type": "single_choice",
      "options": [
        "Que le firewall est désactivé.",
        "Que Symfony ne va pas essayer de lire ou créer une session PHP pour stocker l'utilisateur. L'authentification doit être fournie à chaque requête.",
        "Que l'état est stocké en base de données.",
        "Que l'utilisateur est anonyme."
      ],
      "correct_answers": [
        "Que Symfony ne va pas essayer de lire ou créer une session PHP pour stocker l'utilisateur. L'authentification doit être fournie à chaque requête."
      ],
      "explanation": "C'est la configuration typique pour une API REST sécurisée par Token (JWT)."
    },
    {
      "id": 2,
      "question": "À quoi sert l'option `lazy: true` ?",
      "type": "single_choice",
      "options": [
        "À charger le firewall plus tard.",
        "À ne démarrer la session et charger l'utilisateur que si l'application en a réellement besoin (ex: `is_granted`).",
        "À rendre le site plus lent.",
        "À désactiver le firewall."
      ],
      "correct_answers": [
        "À ne démarrer la session et charger l'utilisateur que si l'application en a réellement besoin (ex: `is_granted`)."
      ],
      "explanation": "Cela permet de rendre les pages publiques cachables et plus rapides, car aucune session n'est démarrée inutilement."
    },
    {
      "id": 3,
      "question": "Quelle fonctionnalité permet à un administrateur de se connecter en tant qu'un autre utilisateur ?",
      "type": "single_choice",
      "options": [
        "`impersonate_user`",
        "`switch_user`",
        "`login_as`",
        "`sudo_mode`"
      ],
      "correct_answers": [
        "`switch_user`"
      ],
      "explanation": "On l'active dans le firewall et on utilise un paramètre d'URL spécial (ex: `?_switch_user=username`)."
    },
    {
      "id": 4,
      "question": "Un pare-feu (`security.yaml`) gère-t-il l'Autorisation (qui a accès à quoi) ?",
      "type": "single_choice",
      "options": [
        "Oui, via l'option `access_control` intégrée.",
        "Non, le pare-feu gère l'Authentification (qui est connecté). L'Autorisation est gérée par `access_control` (global) ou les Voters.",
        "Oui, si on met `security: true`.",
        "Seulement pour l'admin."
      ],
      "correct_answers": [
        "Non, le pare-feu gère l'Authentification (qui est connecté). L'Autorisation est gérée par `access_control` (global) ou les Voters."
      ],
      "explanation": "C'est une distinction fondamentale. Le firewall établit l'identité, l'Access Control restreint l'accès."
    },
    {
      "id": 5,
      "question": "Par défaut, l'authentification est-elle partagée entre deux firewalls différents (ex: main et admin) ?",
      "type": "single_choice",
      "options": [
        "Oui, toujours.",
        "Non, chaque firewall est isolé. Pour partager l'authentification, il faut qu'ils aient le même `context`.",
        "Oui, si ils utilisent le même provider.",
        "Seulement si `stateless: true`."
      ],
      "correct_answers": [
        "Non, chaque firewall est isolé. Pour partager l'authentification, il faut qu'ils aient le même `context`."
      ],
      "explanation": "Si vous vous connectez sur le firewall 'main', vous ne serez pas connecté sur le firewall 'admin' à moins d'avoir configuré le même contexte de session."
    },
    {
      "id": 6,
      "question": "Que fait `security: false` dans un firewall ?",
      "type": "single_choice",
      "options": [
        "Désactive complètement tous les listeners de sécurité pour ce pattern (pas de session, pas d'user)",
        "Force stateless",
        "Supprime les rôles",
        "Active le debug"
      ],
      "correct_answers": [
        "Désactive complètement tous les listeners de sécurité pour ce pattern (pas de session, pas d'user)"
      ],
      "explanation": "Utilisé pour profiler/assets en dev."
    },
    {
      "id": 7,
      "question": "Pourquoi `lazy: true` est-il recommandé sur un firewall stateful ?",
      "type": "single_choice",
      "options": [
        "Pour ne charger l'utilisateur/session que si nécessaire, améliorant perf et cacheabilité des pages publiques",
        "Pour retarder les erreurs",
        "Pour forcer HTTPS",
        "Pour désactiver CSRF"
      ],
      "correct_answers": [
        "Pour ne charger l'utilisateur/session que si nécessaire, améliorant perf et cacheabilité des pages publiques"
      ],
      "explanation": "Lazy évite de démarrer une session inutilement."
    },
    {
      "id": 8,
      "question": "Quel paramètre de firewall utiliser pour une API JWT sans session ?",
      "type": "single_choice",
      "options": [
        "`stateless: true`",
        "`lazy: true`",
        "`switch_user: true`",
        "`security: false`"
      ],
      "correct_answers": [
        "`stateless: true`"
      ],
      "explanation": "Stateless désactive la session : le token doit être envoyé à chaque requête."
    },
    {
      "id": 9,
      "question": "Comment limiter l'impersonnation au rôle autorisé ?",
      "type": "single_choice",
      "options": [
        "Donner `ROLE_ALLOWED_TO_SWITCH` à l'admin",
        "Mettre `switch_user: false`",
        "Utiliser `IS_IMPERSONATOR`",
        "Impossible"
      ],
      "correct_answers": [
        "Donner `ROLE_ALLOWED_TO_SWITCH` à l'admin"
      ],
      "explanation": "Le rôle spécial autorise switch_user."
    },
    {
      "id": 10,
      "question": "Pourquoi l'ordre des firewalls est-il critique ?",
      "type": "single_choice",
      "options": [
        "Premier pattern qui matche gagne; mettre le plus spécifique avant le générique",
        "Parce que Symfony trie par nom",
        "Aucune importance",
        "Uniquement pour les roles"
      ],
      "correct_answers": [
        "Premier pattern qui matche gagne; mettre le plus spécifique avant le générique"
      ],
      "explanation": "Éviter qu'un firewall générique capture tout (ex: main) avant un firewall /api."
    }
  ]
}