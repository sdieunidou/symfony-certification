{
  "source_file": "10-securite/voters.md",
  "title": "Voters (Système de Vote)",
  "questions": [
    {
      "id": 1,
      "question": "Quel est le rôle d'un Voter ?",
      "type": "single_choice",
      "options": [
        "Voter pour les élections.",
        "Prendre une décision granulaire sur l'autorisation d'accès à une ressource (Logique métier).",
        "Authentifier l'utilisateur.",
        "Gérer les rôles."
      ],
      "correct_answers": [
        "Prendre une décision granulaire sur l'autorisation d'accès à une ressource (Logique métier)."
      ],
      "explanation": "Il répond à la question : \"Est-ce que cet utilisateur peut faire cette action sur cet objet ?\"."
    },
    {
      "id": 2,
      "question": "Quelles sont les trois réponses possibles d'un Voter ?",
      "type": "single_choice",
      "options": [
        "True, False, Null",
        "Granted, Denied, Abstain",
        "Yes, No, Maybe",
        "Allow, Block, Pass"
      ],
      "correct_answers": [
        "Granted, Denied, Abstain"
      ],
      "explanation": "Abstain signifie que le voter n'est pas concerné par l'attribut ou l'objet demandé."
    },
    {
      "id": 3,
      "question": "Quelle méthode du Voter détermine s'il doit voter ou s'abstenir ?",
      "type": "single_choice",
      "options": [
        "`vote()`",
        "`supports(string \\$attribute, mixed \\$subject)`",
        "`canVote()`",
        "`decide()`"
      ],
      "correct_answers": [
        "`supports(string \\$attribute, mixed \\$subject)`"
      ],
      "explanation": "Si `supports` retourne false, le voter retourne `ACCESS_ABSTAIN`."
    },
    {
      "id": 4,
      "question": "Si la stratégie de l'`AccessDecisionManager` est `affirmative` (défaut), que se passe-t-il si un voter accorde l'accès et un autre le refuse ?",
      "type": "single_choice",
      "options": [
        "L'accès est refusé.",
        "L'accès est accordé (Dès qu'un voter dit Oui, c'est gagné).",
        "Une exception est levée.",
        "Cela dépend de l'ordre."
      ],
      "correct_answers": [
        "L'accès est accordé (Dès qu'un voter dit Oui, c'est gagné)."
      ],
      "explanation": "Pour une sécurité plus stricte, on peut utiliser la stratégie `unanimous`."
    },
    {
      "id": 5,
      "question": "Pourquoi ne faut-il jamais faire de requête en base de données dans la méthode `supports()` d'un Voter ?",
      "type": "single_choice",
      "options": [
        "C'est interdit par PHP.",
        "Parce que `supports()` est appelé à chaque vérification de sécurité (pour tous les voters), cela tuerait les performances.",
        "Parce que l'EntityManager n'est pas disponible.",
        "C'est possible et recommandé."
      ],
      "correct_answers": [
        "Parce que `supports()` est appelé à chaque vérification de sécurité (pour tous les voters), cela tuerait les performances."
      ],
      "explanation": "`supports()` doit être extrêmement rapide (vérification de type et de string uniquement). La logique lourde va dans `voteOnAttribute()`."
    },
    {
      "id": 6,
      "question": "Quel type de retour produit un voter dans `voteOnAttribute` ?",
      "type": "single_choice",
      "options": [
        "bool (true/false) qui sera converti en ACCESS_GRANTED/ACCESS_DENIED",
        "string",
        "int",
        "array"
      ],
      "correct_answers": [
        "bool (true/false) qui sera converti en ACCESS_GRANTED/ACCESS_DENIED"
      ],
      "explanation": "La classe Voter transforme le bool en décision de vote."
    },
    {
      "id": 7,
      "question": "Comment injecter des services (ex: Repository) dans un Voter ?",
      "type": "single_choice",
      "options": [
        "Comme dans n'importe quel service via le constructeur (autowiring)",
        "Impossible",
        "Via une variable globale",
        "Via Twig"
      ],
      "correct_answers": [
        "Comme dans n'importe quel service via le constructeur (autowiring)"
      ],
      "explanation": "Les voters sont des services standards autowirés."
    },
    {
      "id": 8,
      "question": "Pourquoi utiliser un voter au lieu de vérifier directement dans le contrôleur ?",
      "type": "single_choice",
      "options": [
        "Centraliser la logique métier de sécurité, la rendre testable et réutilisable (Twig, services)",
        "C'est obligatoire",
        "Pour aller plus vite",
        "Pour éviter CSRF"
      ],
      "correct_answers": [
        "Centraliser la logique métier de sécurité, la rendre testable et réutilisable (Twig, services)"
      ],
      "explanation": "Un seul endroit pour les règles, utilisé partout via is_granted."
    },
    {
      "id": 9,
      "question": "Avec la stratégie affirmative, qu'advient-il si un voter s'abstient et un autre refuse ?",
      "type": "single_choice",
      "options": [
        "L'accès est refusé (aucun voter ne dit oui)",
        "L'accès est accordé",
        "Une exception est levée",
        "Cela dépend du provider"
      ],
      "correct_answers": [
        "L'accès est refusé (aucun voter ne dit oui)"
      ],
      "explanation": "Affirmative n'accorde que si au moins un voter GRANT."
    },
    {
      "id": 10,
      "question": "Comment restreindre l'évaluation d'un voter à un type d'objet précis ?",
      "type": "single_choice",
      "options": [
        "En filtrant dans `supports()` (ex: `$subject instanceof Post`)",
        "En configurant access_control",
        "En changeant role_hierarchy",
        "Impossible"
      ],
      "correct_answers": [
        "En filtrant dans `supports()` (ex: `$subject instanceof Post`)"
      ],
      "explanation": "supports doit rapidement éliminer les sujets non concernés."
    }
  ]
}