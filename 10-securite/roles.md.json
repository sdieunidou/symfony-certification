{
  "source_file": "10-securite/roles.md",
  "title": "Rôles et Hiérarchie",
  "questions": [
    {
      "id": 1,
      "question": "Quelle convention de nommage est obligatoire pour qu'une chaîne de caractères soit reconnue comme un rôle par le `RoleVoter` ?",
      "type": "single_choice",
      "options": [
        "Elle doit être en majuscules.",
        "Elle doit commencer par `ROLE_`.",
        "Elle ne doit pas contenir d'espaces.",
        "Il n'y a pas de convention."
      ],
      "correct_answers": [
        "Elle doit commencer par `ROLE_`."
      ],
      "explanation": "Le `RoleVoter` ignore tout attribut qui ne commence pas par ce préfixe."
    },
    {
      "id": 2,
      "question": "À quoi sert la configuration `role_hierarchy` ?",
      "type": "single_choice",
      "options": [
        "À définir quels rôles peuvent se connecter.",
        "À définir l'héritage des permissions (ex: `ROLE_ADMIN` possède automatiquement `ROLE_USER`).",
        "À trier les utilisateurs.",
        "À créer de nouveaux rôles."
      ],
      "correct_answers": [
        "À définir l'héritage des permissions (ex: `ROLE_ADMIN` possède automatiquement `ROLE_USER`)."
      ],
      "explanation": "Cela évite de devoir assigner manuellement tous les sous-rôles à un utilisateur."
    },
    {
      "id": 3,
      "question": "Quel rôle virtuel indique qu'un utilisateur est connecté explicitement (pas via 'Se souvenir de moi') ?",
      "type": "single_choice",
      "options": [
        "`IS_AUTHENTICATED_ANONYMOUSLY`",
        "`IS_AUTHENTICATED_REMEMBERED`",
        "`IS_AUTHENTICATED_FULLY`",
        "`ROLE_USER`"
      ],
      "correct_answers": [
        "`IS_AUTHENTICATED_FULLY`"
      ],
      "explanation": "C'est le niveau de confiance le plus élevé."
    },
    {
      "id": 4,
      "question": "Quel rôle virtuel est possédé par tout le monde, y compris les utilisateurs anonymes ?",
      "type": "single_choice",
      "options": [
        "`IS_ANONYMOUS`",
        "`PUBLIC_ACCESS`",
        "`ROLE_GUEST`",
        "`ALL`"
      ],
      "correct_answers": [
        "`PUBLIC_ACCESS`"
      ],
      "explanation": "C'est un attribut spécial utilisé dans `access_control` pour ouvrir une route."
    },
    {
      "id": 5,
      "question": "Qu'appelle-t-on les 'Reachable Roles' ?",
      "type": "single_choice",
      "options": [
        "Les rôles stockés en base de données.",
        "L'ensemble des rôles qu'un utilisateur possède effectivement, c'est-à-dire ses rôles directs PLUS tous les rôles hérités via la hiérarchie.",
        "Les rôles accessibles via l'URL.",
        "Les rôles que l'utilisateur peut donner aux autres."
      ],
      "correct_answers": [
        "L'ensemble des rôles qu'un utilisateur possède effectivement, c'est-à-dire ses rôles directs PLUS tous les rôles hérités via la hiérarchie."
      ],
      "explanation": "C'est cette liste calculée qui est utilisée par `is_granted`."
    },
    {
      "id": 6,
      "question": "Quel voter natif évalue les rôles `ROLE_*` ?",
      "type": "single_choice",
      "options": [
        "RoleVoter",
        "AuthenticatedVoter",
        "ExpressionVoter",
        "AccessDecisionVoter"
      ],
      "correct_answers": [
        "RoleVoter"
      ],
      "explanation": "RoleVoter se prononce sur les attributs commençant par ROLE_."
    },
    {
      "id": 7,
      "question": "Un utilisateur sans rôle explicite doit-il tout de même avoir un rôle ?",
      "type": "single_choice",
      "options": [
        "Oui, généralement `ROLE_USER` ajouté par `getRoles()`",
        "Non",
        "Uniquement en prod",
        "Seulement pour les admins"
      ],
      "correct_answers": [
        "Oui, généralement `ROLE_USER` ajouté par `getRoles()`"
      ],
      "explanation": "Bonne pratique : garantir au moins un rôle."
    },
    {
      "id": 8,
      "question": "Comment vérifier un rôle dans Twig ?",
      "type": "single_choice",
      "options": [
        "`{% if is_granted('ROLE_ADMIN') %}`",
        "`{{ role('ROLE_ADMIN') }}`",
        "`{% if has_role('ROLE_ADMIN') %}`",
        "`{% check 'ROLE_ADMIN' %}`"
      ],
      "correct_answers": [
        "`{% if is_granted('ROLE_ADMIN') %}`"
      ],
      "explanation": "Twig expose is_granted pour les permissions."
    },
    {
      "id": 9,
      "question": "Quel rôle virtuel correspond à un utilisateur connecté via cookie remember-me ?",
      "type": "single_choice",
      "options": [
        "`IS_AUTHENTICATED_REMEMBERED`",
        "`IS_AUTHENTICATED_FULLY`",
        "`ROLE_REMEMBERED`",
        "`PUBLIC_ACCESS`"
      ],
      "correct_answers": [
        "`IS_AUTHENTICATED_REMEMBERED`"
      ],
      "explanation": "REMEMBERED inclut FULLY."
    },
    {
      "id": 10,
      "question": "Pourquoi la hiérarchie de rôles simplifie-t-elle les règles d'accès ?",
      "type": "single_choice",
      "options": [
        "On peut vérifier seulement le rôle le plus élevé au lieu de tous les sous-rôles",
        "Elle supprime les rôles",
        "Elle remplace les voters",
        "Elle force la stateless"
      ],
      "correct_answers": [
        "On peut vérifier seulement le rôle le plus élevé au lieu de tous les sous-rôles"
      ],
      "explanation": "Moins de duplication et de gestion en base."
    }
  ]
}