{
  "source_file": "10-securite/access-control.md",
  "title": "Règles de Contrôle d'Accès (Access Control)",
  "questions": [
    {
      "id": 1,
      "question": "Quelle règle fondamentale s'applique à la liste `access_control` dans `security.yaml` ?",
      "type": "single_choice",
      "options": [
        "Toutes les règles sont vérifiées et cumulées.",
        "First Match Wins (La première règle qui correspond à l'URL gagne et arrête la recherche).",
        "La règle la plus spécifique gagne.",
        "Last Match Wins."
      ],
      "correct_answers": [
        "First Match Wins (La première règle qui correspond à l'URL gagne et arrête la recherche)."
      ],
      "explanation": "L'ordre des règles est donc critique. Les règles spécifiques doivent être placées avant les règles génériques."
    },
    {
      "id": 2,
      "question": "Quel attribut permet d'autoriser l'accès à tout le monde (même non connecté) pour une URL spécifique ?",
      "type": "single_choice",
      "options": [
        "`PUBLIC_ACCESS`",
        "`IS_ANONYMOUS`",
        "`ROLE_USER`",
        "`ALL`"
      ],
      "correct_answers": [
        "`PUBLIC_ACCESS`"
      ],
      "explanation": "C'est un attribut spécial utilisé dans la clé `roles` pour désactiver la sécurité sur un path."
    },
    {
      "id": 3,
      "question": "Quelle est la différence entre `IS_AUTHENTICATED_FULLY` et `IS_AUTHENTICATED_REMEMBERED` ?",
      "type": "single_choice",
      "options": [
        "`FULLY` signifie que l'utilisateur est admin.",
        "`FULLY` signifie connecté via la session courante (login explicite), `REMEMBERED` inclut aussi les utilisateurs reconnus via un cookie 'Se souvenir de moi'.",
        "`REMEMBERED` est plus sécurisé.",
        "C'est la même chose."
      ],
      "correct_answers": [
        "`FULLY` signifie connecté via la session courante (login explicite), `REMEMBERED` inclut aussi les utilisateurs reconnus via un cookie 'Se souvenir de moi'."
      ],
      "explanation": "Pour les actions sensibles (changement de mot de passe, paiement), on exige souvent `IS_AUTHENTICATED_FULLY`."
    },
    {
      "id": 4,
      "question": "Peut-on restreindre l'accès par adresse IP dans `access_control` ?",
      "type": "single_choice",
      "options": [
        "Non, il faut un firewall.",
        "Oui, via l'option `ips` (ex: `ips: [127.0.0.1]`).",
        "Oui, via l'option `host`.",
        "Seulement en production."
      ],
      "correct_answers": [
        "Oui, via l'option `ips` (ex: `ips: [127.0.0.1]`)."
      ],
      "explanation": "C'est utile pour sécuriser une zone d'administration ou des outils internes."
    },
    {
      "id": 5,
      "question": "Quelle option permet d'écrire une règle d'accès complexe utilisant le langage d'expression (ex: `is_granted('ROLE_ADMIN') or request.getClientIp() == '...'`) ?",
      "type": "single_choice",
      "options": [
        "`expression`",
        "`allow_if`",
        "`roles`",
        "`condition`"
      ],
      "correct_answers": [
        "`allow_if`"
      ],
      "explanation": "Cela donne accès à l'objet request, user, et aux fonctions de sécurité pour des règles fines."
    },
    {
      "id": 6,
      "question": "Que se passe-t-il si une règle `access_control` plus générique est placée avant une règle spécifique ?",
      "type": "single_choice",
      "options": [
        "La règle spécifique l'emporte",
        "La règle générique matche en premier et bloque la spécifique (First Match Wins)",
        "Les deux sont évaluées et combinées",
        "Une erreur est levée"
      ],
      "correct_answers": [
        "La règle générique matche en premier et bloque la spécifique (First Match Wins)"
      ],
      "explanation": "D'où l'importance de l'ordre : du plus spécifique au plus générique."
    },
    {
      "id": 7,
      "question": "Comment forcer le HTTPS pour un pattern dans `access_control` ?",
      "type": "single_choice",
      "options": [
        "Avec `requires_channel: https`",
        "En configurant Apache",
        "En ajoutant `https: true`",
        "Ce n'est pas possible"
      ],
      "correct_answers": [
        "Avec `requires_channel: https`"
      ],
      "explanation": "La directive redirige vers HTTPS pour le path concerné."
    },
    {
      "id": 8,
      "question": "Quelle différence entre firewall et access_control ?",
      "type": "single_choice",
      "options": [
        "Firewall gère l'authentification (qui je suis), access_control l'autorisation (ai-je le droit)",
        "Aucune, ce sont des synonymes",
        "Firewall gère les rôles, access_control gère les providers",
        "Firewall est optionnel"
      ],
      "correct_answers": [
        "Firewall gère l'authentification (qui je suis), access_control l'autorisation (ai-je le droit)"
      ],
      "explanation": "Deux couches distinctes : identité vs accès."
    },
    {
      "id": 9,
      "question": "Quel attribut virtuel autorise l'accès même à un utilisateur impersonné ?",
      "type": "single_choice",
      "options": [
        "`IS_IMPERSONATOR`",
        "`ROLE_PREVIOUS_ADMIN`",
        "`PUBLIC_ACCESS`",
        "`IS_SWITCHED`"
      ],
      "correct_answers": [
        "`IS_IMPERSONATOR`"
      ],
      "explanation": "IS_IMPERSONATOR est vrai quand on est en switch_user."
    },
    {
      "id": 10,
      "question": "Quelle est la bonne pratique pour autoriser le profiler et les assets en dev ?",
      "type": "single_choice",
      "options": [
        "Mettre une règle `PUBLIC_ACCESS` sur `^/(_(profiler|wdt)|css|images|js)/` en tête",
        "Les laisser protégés par ROLE_ADMIN",
        "Ne rien configurer",
        "Mettre après les règles admin"
      ],
      "correct_answers": [
        "Mettre une règle `PUBLIC_ACCESS` sur `^/(_(profiler|wdt)|css|images|js)/` en tête"
      ],
      "explanation": "On exclut ces routes en premier pour éviter les redirections boucle."
    }
  ]
}