{
  "source_file": "14-divers/configuration.md",
  "title": "Configuration & Environnements",
  "questions": [
    {
      "id": 1,
      "question": "Quelle source a la priorité absolue pour une variable d'env ?",
      "type": "single_choice",
      "options": [
        "Variable d'environnement système réelle",
        ".env.local",
        ".env",
        ".env.prod"
      ],
      "correct_answers": [
        "Variable d'environnement système réelle"
      ],
      "explanation": "Les valeurs réelles (export/serveur) l'emportent sur les fichiers."
    },
    {
      "id": 2,
      "question": "Quelle commande permet de voir la configuration finale (résolue) d'un bundle, après fusion de tous les fichiers YAML ?",
      "type": "single_choice",
      "options": [
        "`php bin/console config:dump-reference`",
        "`php bin/console debug:config`",
        "`php bin/console debug:container`",
        "`php bin/console config:list`"
      ],
      "correct_answers": [
        "`php bin/console debug:config`"
      ],
      "explanation": "`debug:config` montre ce que Symfony utilise réellement, tandis que `config:dump-reference` montre toutes les options disponibles."
    },
    {
      "id": 3,
      "question": "Comment injecter un paramètre de configuration (défini dans `parameters:`) directement dans le constructeur d'un service via un attribut ?",
      "type": "single_choice",
      "options": [
        "`#[Inject('%parameter_name%')]`",
        "`#[Autowire('%parameter_name%')]`",
        "`#[Param('parameter_name')]`",
        "`#[Value('%parameter_name%')]`"
      ],
      "correct_answers": [
        "`#[Autowire('%parameter_name%')]`"
      ],
      "explanation": "L'attribut `#[Autowire]` permet d'injecter des paramètres scalaires (entourés de `%`) ou des variables d'env."
    },
    {
      "id": 4,
      "question": "Quel processeur de variable d'environnement permet de lire le contenu d'un fichier (utile pour les secrets Docker) ?",
      "type": "single_choice",
      "options": [
        "`%env(read:VAR)%`",
        "`%env(file:VAR)%`",
        "`%env(content:VAR)%`",
        "`%env(json:VAR)%`"
      ],
      "correct_answers": [
        "`%env(file:VAR)%`"
      ],
      "explanation": "Le processeur `file:` considère la valeur de la variable comme un chemin de fichier et retourne son contenu."
    },
    {
      "id": 5,
      "question": "Quelle commande permet d'ajouter un secret chiffré dans le coffre-fort (Vault) de l'application ?",
      "type": "single_choice",
      "options": [
        "`php bin/console secrets:add`",
        "`php bin/console secrets:set`",
        "`php bin/console vault:store`",
        "`php bin/console env:encrypt`"
      ],
      "correct_answers": [
        "`php bin/console secrets:set`"
      ],
      "explanation": "Cette commande chiffre la valeur avec la clé publique et la stocke dans `config/secrets/{env}/{nom}.{env}.list`."
    },
    {
      "id": 6,
      "question": "Ordre de chargement des fichiers de config dans `config/packages` ?",
      "type": "single_choice",
      "options": [
        "Globaux puis spécifiques env (`config/packages/*.yaml` puis `config/packages/{env}/*.yaml`)",
        "Spécifiques env puis globaux",
        "Aléatoire",
        "Uniquement globaux"
      ],
      "correct_answers": [
        "Globaux puis spécifiques env (`config/packages/*.yaml` puis `config/packages/{env}/*.yaml`)"
      ],
      "explanation": "Les fichiers env surchargent les globaux."
    },
    {
      "id": 7,
      "question": "Comment injecter une variable d'env transformée en array JSON ?",
      "type": "single_choice",
      "options": [
        "`#[Autowire(env: 'json:MY_FLAGS')]`",
        "`#[Autowire('%json:MY_FLAGS%')]`",
        "`#[Env(json: MY_FLAGS)]`",
        "`%env(json:MY_FLAGS)%` uniquement dans Twig"
      ],
      "correct_answers": [
        "`#[Autowire(env: 'json:MY_FLAGS')]`"
      ],
      "explanation": "Autowire avec `env:` accepte les processeurs (json) et injecte un array."
    },
    {
      "id": 8,
      "question": "Quand utiliser ContainerBagInterface plutôt que l'injection directe ?",
      "type": "single_choice",
      "options": [
        "Pour un accès programmatique ponctuel, pas pour des dépendances scalaires fréquentes",
        "Toujours",
        "Jamais",
        "Pour les services publics"
      ],
      "correct_answers": [
        "Pour un accès programmatique ponctuel, pas pour des dépendances scalaires fréquentes"
      ],
      "explanation": "L'injection directe est préférée; ContainerBag sert de fallback."
    },
    {
      "id": 9,
      "question": "Quel outil Symfony permet de voir toutes les options configurables d'un bundle avec leurs valeurs par défaut ?",
      "type": "single_choice",
      "options": [
        "`config:dump-reference <bundle>`",
        "`debug:container`",
        "`debug:config`",
        "`router:match`"
      ],
      "correct_answers": [
        "`config:dump-reference <bundle>`"
      ],
      "explanation": "config:dump-reference liste la référence complète des options."
    },
    {
      "id": 10,
      "question": "Pourquoi utiliser `composer dump-env prod` ?",
      "type": "single_choice",
      "options": [
        "Compiler les .env en PHP (`.env.local.php`) pour éviter leur parsing à chaque requête",
        "Chiffrer les .env",
        "Créer un docker-compose",
        "Activer debug"
      ],
      "correct_answers": [
        "Compiler les .env en PHP (`.env.local.php`) pour éviter leur parsing à chaque requête"
      ],
      "explanation": "dump-env génère un cache PHP rapide des variables."
    }
  ]
}