{
  "source_file": "14-divers/performance.md",
  "title": "Performance",
  "questions": [
    {
      "id": 1,
      "question": "Optimisation PHP cruciale en prod ?",
      "type": "single_choice",
      "options": [
        "OPcache avec validate_timestamps=0",
        "Xdebug",
        "Désactiver OPCache",
        "Activer JIT uniquement"
      ],
      "correct_answers": [
        "OPcache avec validate_timestamps=0"
      ],
      "explanation": "Supprime les checks de fichiers, nécessite restart après déploiement."
    },
    {
      "id": 2,
      "question": "À quoi sert l'option Composer `--classmap-authoritative` ?",
      "type": "single_choice",
      "options": [
        "À installer uniquement les dépendances de prod.",
        "À générer une map statique de toutes les classes. Si une classe n'est pas dans la map, l'autoloader ne vérifie même pas le disque.",
        "À vérifier les licences.",
        "À optimiser les images."
      ],
      "correct_answers": [
        "À générer une map statique de toutes les classes. Si une classe n'est pas dans la map, l'autoloader ne vérifie même pas le disque."
      ],
      "explanation": "C'est une optimisation majeure de l'autoloading en production."
    },
    {
      "id": 3,
      "question": "Comment utiliser le composant `Stopwatch` pour profiler une partie spécifique de votre code ?",
      "type": "single_choice",
      "options": [
        "`$stopwatch->start('event_name'); ... $stopwatch->stop('event_name');`",
        "`$stopwatch->measure(function() { ... });`",
        "`Stopwatch::start() ... Stopwatch::stop()`",
        "`dump($var)`"
      ],
      "correct_answers": [
        "`$stopwatch->start('event_name'); ... $stopwatch->stop('event_name');`"
      ],
      "explanation": "L'événement apparaîtra ensuite dans la Timeline du Web Profiler."
    },
    {
      "id": 4,
      "question": "Qu'est-ce que le Preloading PHP (7.4+) ?",
      "type": "single_choice",
      "options": [
        "Un mécanisme pour charger les assets CSS avant le HTML.",
        "Une fonctionnalité d'OPcache qui charge et compile les classes PHP en mémoire au démarrage du serveur (avant toute requête).",
        "Un système de cache de base de données.",
        "Le chargement anticipé des images."
      ],
      "correct_answers": [
        "Une fonctionnalité d'OPcache qui charge et compile les classes PHP en mémoire au démarrage du serveur (avant toute requête)."
      ],
      "explanation": "Symfony génère un script de preload optimisé dans `var/cache/prod`."
    },
    {
      "id": 5,
      "question": "Quel est l'impact de l'augmentation du `realpath_cache_size` dans php.ini ?",
      "type": "single_choice",
      "options": [
        "Cela consomme plus de disque.",
        "Cela permet à PHP de garder en mémoire les chemins de fichiers résolus plus longtemps, réduisant les appels système (stat) pour les projets avec beaucoup de fichiers.",
        "Cela ralentit le serveur.",
        "Cela n'a aucun impact sur Symfony."
      ],
      "correct_answers": [
        "Cela permet à PHP de garder en mémoire les chemins de fichiers résolus plus longtemps, réduisant les appels système (stat) pour les projets avec beaucoup de fichiers."
      ],
      "explanation": "Symfony comportant des milliers de fichiers, le cache realpath par défaut est souvent insuffisant."
    },
    {
      "id": 6,
      "question": "À quoi sert `.container.dumper.inline_factories: true` ?",
      "type": "single_choice",
      "options": [
        "Compiler le conteneur en un seul fichier favorable au preloading",
        "Rendre les services publics",
        "Activer Xdebug",
        "Désactiver le cache"
      ],
      "correct_answers": [
        "Compiler le conteneur en un seul fichier favorable au preloading"
      ],
      "explanation": "Réduit le nombre de fichiers chargés et favorise preload/OPcache."
    },
    {
      "id": 7,
      "question": "Pourquoi limiter `framework.enabled_locales` ?",
      "type": "single_choice",
      "options": [
        "Éviter de charger des fichiers de traduction inutiles",
        "Activer toutes les langues",
        "Obligatoire en dev",
        "Accélérer Twig"
      ],
      "correct_answers": [
        "Éviter de charger des fichiers de traduction inutiles"
      ],
      "explanation": "Moins de locales = moins de ressources chargées."
    },
    {
      "id": 8,
      "question": "Pourquoi désactiver `debug.container.dump` sur gros projets ?",
      "type": "single_choice",
      "options": [
        "Le dump XML du conteneur ralentit fortement le cache warmup",
        "Cela supprime les logs",
        "Cela désactive le profiler",
        "Cela casse Twig"
      ],
      "correct_answers": [
        "Le dump XML du conteneur ralentit fortement le cache warmup"
      ],
      "explanation": "Le fichier généré devient énorme et coûteux."
    },
    {
      "id": 9,
      "question": "Pourquoi OPcache.preload est utile ?",
      "type": "single_choice",
      "options": [
        "Charge et compile les classes au démarrage, évitant l'I/O par requête",
        "Désactive OPcache",
        "Active debug",
        "Génère les assets"
      ],
      "correct_answers": [
        "Charge et compile les classes au démarrage, évitant l'I/O par requête"
      ],
      "explanation": "Preload profite aux apps long-running ou à forte charge."
    },
    {
      "id": 10,
      "question": "Quel outil de profiling avancé est recommandé pour investiguer CPU/IO en profondeur ?",
      "type": "single_choice",
      "options": [
        "Blackfire",
        "Stopwatch",
        "dump()",
        "Logger"
      ],
      "correct_answers": [
        "Blackfire"
      ],
      "explanation": "Blackfire produit des call graphs détaillés pour les optimisations fines."
    }
  ]
}