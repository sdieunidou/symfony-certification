{
  "source_file": "13-tests-automatises/framework-access.md",
  "title": "Accès aux Objets du Framework (Intégration)",
  "questions": [
    {
      "id": 1,
      "question": "Comment accéder au conteneur de services dans un test d'intégration (`KernelTestCase`) ?",
      "type": "single_choice",
      "options": [
        "`$this->container`",
        "`static::getContainer()` (après `self::bootKernel()`)",
        "`$client->getContainer()`",
        "On ne peut pas."
      ],
      "correct_answers": [
        "`static::getContainer()` (après `self::bootKernel()`)"
      ],
      "explanation": "Cette méthode retourne le conteneur de test spécial qui permet d'accéder aux services privés."
    },
    {
      "id": 2,
      "question": "Est-il possible de remplacer un service par un Mock dans le conteneur de test ?",
      "type": "single_choice",
      "options": [
        "Non, le conteneur est immuable.",
        "Oui, en utilisant `$container->set('service_id', $mock)`.",
        "Oui, mais seulement dans `config/services_test.yaml`.",
        "Oui, en utilisant `$container->override(...)`."
      ],
      "correct_answers": [
        "Oui, en utilisant `$container->set('service_id', $mock)`."
      ],
      "explanation": "Le conteneur de test est modifiable au runtime, contrairement au conteneur de production."
    },
    {
      "id": 3,
      "question": "Pourquoi est-il recommandé de désactiver le mode debug (`debug => false`) pour les tests automatisés ?",
      "type": "single_choice",
      "options": [
        "Pour des raisons de sécurité.",
        "Pour améliorer significativement les performances (évite la re-génération des fichiers de cache à chaque requête).",
        "Parce que le mode debug casse les tests.",
        "C'est faux, il faut toujours le mode debug."
      ],
      "correct_answers": [
        "Pour améliorer significativement les performances (évite la re-génération des fichiers de cache à chaque requête)."
      ],
      "explanation": "Le mode debug est utile si un test échoue pour voir la stack trace, mais lent pour la suite complète."
    },
    {
      "id": 4,
      "question": "Quelle méthode statique faut-il appeler pour démarrer l'application Symfony dans un `KernelTestCase` ?",
      "type": "single_choice",
      "options": [
        "`self::start()`",
        "`self::bootKernel()`",
        "`self::createKernel()`",
        "`self::run()`"
      ],
      "correct_answers": [
        "`self::bootKernel()`"
      ],
      "explanation": "Cette méthode initialise le Kernel et le conteneur."
    },
    {
      "id": 5,
      "question": "Dans le conteneur de test (`test.service_container`), quel est le statut de visibilité des services par défaut ?",
      "type": "single_choice",
      "options": [
        "Identique à la production (les services privés restent privés).",
        "Tous les services (même privés) sont rendus publics pour faciliter les tests.",
        "Seuls les services taggés `public: true` sont accessibles.",
        "Le conteneur est vide."
      ],
      "correct_answers": [
        "Tous les services (même privés) sont rendus publics pour faciliter les tests."
      ],
      "explanation": "Cela permet de tester unitairement n'importe quel service sans devoir modifier sa configuration pour les tests."
    },
    {
      "id": 6,
      "question": "Comment remplacer un service par un mock dans un test d'intégration ?",
      "type": "single_choice",
      "options": [
        "En faisant `$container->set('id_service', $mock);` sur le conteneur de test",
        "Impossible, conteneur figé",
        "En modifiant services.yaml",
        "En utilisant @mock"
      ],
      "correct_answers": [
        "En faisant `$container->set('id_service', $mock);` sur le conteneur de test"
      ],
      "explanation": "Le conteneur de test est modifiable au runtime."
    },
    {
      "id": 7,
      "question": "Pourquoi désactiver debug pour la suite de tests (phpunit.xml) ?",
      "type": "single_choice",
      "options": [
        "Améliorer la perf en évitant la régénération de cache à chaque requête",
        "Obligatoire",
        "Pour masquer les erreurs",
        "Pour activer le profiler"
      ],
      "correct_answers": [
        "Améliorer la perf en évitant la régénération de cache à chaque requête"
      ],
      "explanation": "Le mode debug est utile ponctuellement mais coûteux sur toute la suite."
    },
    {
      "id": 8,
      "question": "Quelle méthode donne accès au Kernel dans un `KernelTestCase` ?",
      "type": "single_choice",
      "options": [
        "`self::bootKernel()` puis `static::$kernel`",
        "`self::getKernel()` sans boot",
        "`$this->kernel()`",
        "Impossible"
      ],
      "correct_answers": [
        "`self::bootKernel()` puis `static::$kernel`"
      ],
      "explanation": "bootKernel instancie et stocke le kernel accessible via la propriété statique."
    },
    {
      "id": 9,
      "question": "Quelle commande installe les composants de test (BrowserKit, CssSelector, PHPUnit Bridge) ?",
      "type": "single_choice",
      "options": [
        "`composer require --dev symfony/test-pack`",
        "`composer require phpunit/phpunit` seul",
        "`composer require symfony/browser-kit` seul",
        "`composer require symfony/dom-crawler` seul"
      ],
      "correct_answers": [
        "`composer require --dev symfony/test-pack`"
      ],
      "explanation": "Le test-pack regroupe les dépendances nécessaires pour les tests Symfony."
    },
    {
      "id": 10,
      "question": "Pourquoi `static::getContainer()` retourne un conteneur de test différent du conteneur prod ?",
      "type": "single_choice",
      "options": [
        "Il rend les services privés publics et autorise set(), pour faciliter les tests",
        "Aucune différence",
        "Il charge les services mockés par défaut",
        "Il désactive Doctrine"
      ],
      "correct_answers": [
        "Il rend les services privés publics et autorise set(), pour faciliter les tests"
      ],
      "explanation": "Le conteneur de test est 'déverrouillé' pour l'accès et la substitution."
    }
  ]
}