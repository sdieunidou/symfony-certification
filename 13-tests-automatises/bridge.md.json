{
  "source_file": "13-tests-automatises/bridge.md",
  "title": "Pont PHPUnit (PHPUnit Bridge)",
  "questions": [
    {
      "id": 1,
      "question": "Quelle est la fonctionnalité principale du PHPUnit Bridge dans le contexte d'une migration de version Symfony ?",
      "type": "single_choice",
      "options": [
        "Il améliore les performances des tests.",
        "Il génère un rapport sur les dépréciations (`trigger_deprecation`) déclenchées pendant les tests pour aider à la mise à jour.",
        "Il permet d'écrire des tests en YAML.",
        "Il remplace PHPUnit par Pest."
      ],
      "correct_answers": [
        "Il génère un rapport sur les dépréciations (`trigger_deprecation`) déclenchées pendant les tests pour aider à la mise à jour."
      ],
      "explanation": "Le bridge écoute tous les appels aux dépréciations et fournit un résumé (rouge/vert) à la fin, permettant de viser le 'Deprecation-Free'."
    },
    {
      "id": 2,
      "question": "Comment le PHPUnit Bridge gère-t-il l'installation de PHPUnit ?",
      "type": "single_choice",
      "options": [
        "Il utilise la version installée globalement sur le système.",
        "Il installe une version de PHPUnit isolée et compatible avec le projet dans le dossier `bin/.phpunit/`.",
        "Il télécharge PHPUnit à chaque exécution.",
        "Il n'installe rien."
      ],
      "correct_answers": [
        "Il installe une version de PHPUnit isolée et compatible avec le projet dans le dossier `bin/.phpunit/`."
      ],
      "explanation": "Cela garantit que chaque projet utilise la version de PHPUnit qui correspond à sa version de PHP et de Symfony, sans conflit global."
    },
    {
      "id": 3,
      "question": "À quoi servent les classes `ClockMock` et `DnsMock` fournies par le bridge ?",
      "type": "single_choice",
      "options": [
        "À tester la base de données.",
        "À simuler les fonctions natives PHP liées au temps (`time()`) et au réseau (`checkdnsrr()`) sans modifier le code.",
        "À mocker les services Symfony.",
        "À accélérer l'exécution des tests."
      ],
      "correct_answers": [
        "À simuler les fonctions natives PHP liées au temps (`time()`) et au réseau (`checkdnsrr()`) sans modifier le code."
      ],
      "explanation": "Ces mocks interviennent au niveau du namespace pour surcharger les fonctions natives, ce qui est très utile pour les tests temporels (bien que le composant Clock soit désormais préféré)."
    },
    {
      "id": 4,
      "question": "Par défaut, le bridge rapporte-t-il les dépréciations provenant du dossier `/vendor` ?",
      "type": "single_choice",
      "options": [
        "Oui, toutes.",
        "Non, elles sont généralement ignorées car ce n'est pas votre code.",
        "Uniquement celles de Doctrine.",
        "Oui, si le mode debug est activé."
      ],
      "correct_answers": [
        "Non, elles sont généralement ignorées car ce n'est pas votre code."
      ],
      "explanation": "Le bridge se concentre sur les dépréciations causées par VOTRE code ou l'utilisation que vous faites des bibliothèques, pas les problèmes internes aux bibliothèques tierces."
    },
    {
      "id": 5,
      "question": "Comment activer le listener du PHPUnit Bridge dans la configuration `phpunit.xml.dist` ?",
      "type": "single_choice",
      "options": [
        "C'est automatique, rien à faire.",
        "En ajoutant `<listener class=\"Symfony\\Bridge\\PhpUnit\\SymfonyTestsListener\" />` dans la section `<listeners>`.",
        "En ajoutant `APP_ENV=test` dans `<php>`.",
        "En exécutant `composer require phpunit`."
      ],
      "correct_answers": [
        "En ajoutant `<listener class=\"Symfony\\Bridge\\PhpUnit\\SymfonyTestsListener\" />` dans la section `<listeners>`."
      ],
      "explanation": "Ce listener est essentiel pour que le Bridge puisse intercepter les événements de tests et les dépréciations."
    },
    {
      "id": 6,
      "question": "Quelle variable d'env configure la tolérance aux dépréciations dans le Bridge ?",
      "type": "single_choice",
      "options": [
        "`SYMFONY_DEPRECATIONS_HELPER`",
        "`APP_DEBUG`",
        "`APP_ENV`",
        "`PHPUNIT_DEPRECATIONS`"
      ],
      "correct_answers": [
        "`SYMFONY_DEPRECATIONS_HELPER`"
      ],
      "explanation": "Elle permet de fixer des seuils (max[self], max[direct], etc.)."
    },
    {
      "id": 7,
      "question": "Où le Bridge installe-t-il la version isolée de PHPUnit ?",
      "type": "single_choice",
      "options": [
        "`bin/.phpunit/`",
        "`vendor/phpunit/`",
        "`/usr/local/bin`",
        "`var/phpunit`"
      ],
      "correct_answers": [
        "`bin/.phpunit/`"
      ],
      "explanation": "Le binaire est téléchargé là pour éviter les conflits globaux."
    },
    {
      "id": 8,
      "question": "Comment lister les dépréciations triées par origine après une suite de tests ?",
      "type": "single_choice",
      "options": [
        "Lire le rapport généré par le bridge à la fin de l'exécution (console)",
        "Exécuter `php bin/console debug:deprecations`",
        "Regarder var/log",
        "Impossible"
      ],
      "correct_answers": [
        "Lire le rapport généré par le bridge à la fin de l'exécution (console)"
      ],
      "explanation": "Le bridge affiche un résumé des dépréciations avec catégories."
    },
    {
      "id": 9,
      "question": "Pourquoi les dépréciations des vendors sont ignorées par défaut ?",
      "type": "single_choice",
      "options": [
        "Pour se concentrer sur le code applicatif et éviter le bruit",
        "Parce qu'il y en a trop",
        "Parce que Doctrine l'impose",
        "Parce que PHPUnit ne les supporte pas"
      ],
      "correct_answers": [
        "Pour se concentrer sur le code applicatif et éviter le bruit"
      ],
      "explanation": "L'objectif est d'assainir votre code sans être bloqué par les dépendances."
    },
    {
      "id": 10,
      "question": "Quelle alternative moderne au `ClockMock` est recommandée pour manipuler le temps ?",
      "type": "single_choice",
      "options": [
        "Le composant Clock (`ClockInterface`, `MockClock`)",
        "sleep()",
        "Carbon",
        "DateTime::setTime()"
      ],
      "correct_answers": [
        "Le composant Clock (`ClockInterface`, `MockClock`)"
      ],
      "explanation": "Clock fournit une abstraction testable sans patcher les fonctions globales."
    }
  ]
}