{
  "source_file": "09-injection-dependances/container.md",
  "title": "Conteneur de Services (Service Container)",
  "questions": [
    {
      "id": 1,
      "question": "Par défaut, les services dans Symfony sont-ils publics ou privés ?",
      "type": "single_choice",
      "options": [
        "Publics (accessibles via `$container->get()`).",
        "Privés (accessibles uniquement par injection).",
        "Cela dépend de la version de PHP.",
        "Publics en dev, privés en prod."
      ],
      "correct_answers": [
        "Privés (accessibles uniquement par injection)."
      ],
      "explanation": "Depuis Symfony 4, les services sont privés par défaut pour permettre l'optimisation (suppression des services inutilisés)."
    },
    {
      "id": 2,
      "question": "Qu'est-ce qu'un service 'Synthétique' (Synthetic) ?",
      "type": "single_choice",
      "options": [
        "Un service qui n'existe pas.",
        "Un service qui est injecté dans le conteneur au runtime (ex: `kernel`, `request_stack`) au lieu d'être créé par le conteneur.",
        "Un alias.",
        "Un service déprécié."
      ],
      "correct_answers": [
        "Un service qui est injecté dans le conteneur au runtime (ex: `kernel`, `request_stack`) au lieu d'être créé par le conteneur."
      ],
      "explanation": "Le conteneur ne connaît pas la recette pour les créer, ils viennent de l'extérieur."
    },
    {
      "id": 3,
      "question": "Les services sont-ils des Singletons ?",
      "type": "single_choice",
      "options": [
        "Oui, par défaut, on reçoit toujours la même instance du service durant une même requête.",
        "Non, une nouvelle instance est créée à chaque injection.",
        "Seulement si on ajoute `shared: true`.",
        "Cela dépend de l'autowiring."
      ],
      "correct_answers": [
        "Oui, par défaut, on reçoit toujours la même instance du service durant une même requête."
      ],
      "explanation": "C'est le comportement par défaut. Pour avoir une nouvelle instance à chaque fois, il faut configurer `shared: false`."
    },
    {
      "id": 4,
      "question": "Quelle commande permet de vérifier la validité de la configuration du conteneur (arguments manquants, etc.) ?",
      "type": "single_choice",
      "options": [
        "`php bin/console debug:container`",
        "`php bin/console lint:container`",
        "`php bin/console container:check`",
        "`php bin/console cache:warmup`"
      ],
      "correct_answers": [
        "`php bin/console lint:container`"
      ],
      "explanation": "Cette commande est cruciale en CI pour détecter les erreurs de configuration avant le déploiement."
    },
    {
      "id": 5,
      "question": "Pourquoi injecter le conteneur de services entier (`ContainerInterface`) dans un service est-il considéré comme une mauvaise pratique ?",
      "type": "single_choice",
      "options": [
        "Parce que c'est plus lent.",
        "Cela cache les dépendances réelles de la classe et couple fortement le code au framework (Service Locator pattern).",
        "Le conteneur n'est pas injectable.",
        "Cela provoque des fuites de mémoire."
      ],
      "correct_answers": [
        "Cela cache les dépendances réelles de la classe et couple fortement le code au framework (Service Locator pattern)."
      ],
      "explanation": "Il faut toujours préférer l'injection explicite des dépendances nécessaires."
    },
    {
      "id": 6,
      "question": "Qu'est-ce qu'un service synthétique dans le conteneur ?",
      "type": "single_choice",
      "options": [
        "Un service généré automatiquement",
        "Un service dont l'instance est fournie de l'extérieur et non créée par le conteneur",
        "Un alias",
        "Un service lazy"
      ],
      "correct_answers": [
        "Un service dont l'instance est fournie de l'extérieur et non créée par le conteneur"
      ],
      "explanation": "Le conteneur attend qu'on lui fournisse l'objet (ex: kernel, request_stack)."
    },
    {
      "id": 7,
      "question": "Pourquoi les services sont-ils privés par défaut depuis Symfony 4 ?",
      "type": "single_choice",
      "options": [
        "Pour empêcher l'autowiring",
        "Pour permettre au compilateur d'optimiser (inliner/supprimer) et encourager l'injection",
        "Pour des raisons de sécurité",
        "Parce que les publics sont dépréciés"
      ],
      "correct_answers": [
        "Pour permettre au compilateur d'optimiser (inliner/supprimer) et encourager l'injection"
      ],
      "explanation": "La visibilité privée libère des optimisations et évite l'anti-pattern service locator."
    },
    {
      "id": 8,
      "question": "Quelle commande vérifie la résolution des variables d'environnement dans le conteneur (Symfony 7.2+) ?",
      "type": "single_choice",
      "options": [
        "`php bin/console lint:container --resolve-env-vars`",
        "`php bin/console debug:env`",
        "`php bin/console cache:clear`",
        "`php bin/console about`"
      ],
      "correct_answers": [
        "`php bin/console lint:container --resolve-env-vars`"
      ],
      "explanation": "Assure l'existence et la compatibilité des env vars utilisées dans les defs."
    },
    {
      "id": 9,
      "question": "Quelle différence entre un service public et privé concernant `$container->get()` ?",
      "type": "single_choice",
      "options": [
        "Aucune",
        "Seuls les services publics sont accessibles via `$container->get()`",
        "Seuls les services privés sont accessibles",
        "Tous les services sont accessibles en dev"
      ],
      "correct_answers": [
        "Seuls les services publics sont accessibles via `$container->get()`"
      ],
      "explanation": "Les services privés sont destinés à l'injection uniquement."
    },
    {
      "id": 10,
      "question": "Pourquoi `debug:container` en prod peut montrer moins de services qu'en dev ?",
      "type": "single_choice",
      "options": [
        "Parce que le conteneur prod est optimisé et supprime les services privés inutilisés",
        "Parce que les logs sont désactivés",
        "Parce que le cache est vide",
        "Parce que les contrôleurs sont supprimés"
      ],
      "correct_answers": [
        "Parce que le conteneur prod est optimisé et supprime les services privés inutilisés"
      ],
      "explanation": "Le RemovingPass élimine ce qui n'est pas référencé."
    }
  ]
}