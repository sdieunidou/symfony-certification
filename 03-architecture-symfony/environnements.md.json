{
  "source_file": "03-architecture-symfony/environnements.md",
  "title": "Les Environnements & Configuration",
  "questions": [
    {
      "id": 1,
      "question": "Quelle variable d'environnement définit l'environnement actif de l'application Symfony ?",
      "type": "single_choice",
      "options": [
        "SYMFONY_ENV",
        "APP_ENV",
        "ENV",
        "APP_DEBUG"
      ],
      "correct_answers": [
        "APP_ENV"
      ],
      "explanation": "C'est la variable standard utilisée par le Kernel de Symfony pour charger la configuration correspondante."
    },
    {
      "id": 2,
      "question": "Quel fichier a la priorité la plus élevée pour définir une variable d'environnement (hors variables système réelles) ?",
      "type": "single_choice",
      "options": [
        ".env",
        ".env.local",
        ".env.prod",
        ".env.dist"
      ],
      "correct_answers": [
        ".env.local"
      ],
      "explanation": "Le fichier `.env.local` surcharge les valeurs de `.env`. Cependant, `.env.{env}.local` (ex: `.env.test.local`) serait encore plus prioritaire si l'environnement correspond."
    },
    {
      "id": 3,
      "question": "À quoi sert la variable `APP_DEBUG` ?",
      "type": "single_choice",
      "options": [
        "À définir si on est en environnement de développement.",
        "À activer/désactiver le mode debug (affichage des erreurs détaillées, invalidation automatique du cache).",
        "À activer le Web Profiler uniquement.",
        "À permettre l'installation de nouveaux paquets."
      ],
      "correct_answers": [
        "À activer/désactiver le mode debug (affichage des erreurs détaillées, invalidation automatique du cache)."
      ],
      "explanation": "Elle est indépendante de `APP_ENV`. On peut être en `prod` avec `APP_DEBUG=1` (bien que déconseillé pour les performances)."
    },
    {
      "id": 4,
      "question": "Dans quel dossier sont stockés les caches spécifiques à l'environnement 'prod' ?",
      "type": "single_choice",
      "options": [
        "var/cache/",
        "var/cache/prod/",
        "var/logs/prod/",
        "tmp/symfony/prod/"
      ],
      "correct_answers": [
        "var/cache/prod/"
      ],
      "explanation": "Symfony isole les caches par environnement pour éviter les conflits de configuration."
    },
    {
      "id": 5,
      "question": "Si une variable d'environnement est définie à la fois dans `.env.local` et dans la configuration du serveur web (Apache/Nginx/Docker), laquelle l'emporte ?",
      "type": "single_choice",
      "options": [
        "Celle de `.env.local`.",
        "Celle du serveur web (variable système réelle).",
        "Cela dépend de l'ordre de chargement.",
        "Symfony lance une erreur de conflit."
      ],
      "correct_answers": [
        "Celle du serveur web (variable système réelle)."
      ],
      "explanation": "Les 'vraies' variables d'environnement système ont toujours la priorité absolue sur les fichiers chargés par le composant Dotenv."
    },
    {
      "id": 6,
      "question": "Comment définir une configuration spécifique pour l'environnement de test uniquement ?",
      "type": "single_choice",
      "options": [
        "Créer un fichier `config/packages/test/framework.yaml`.",
        "Utiliser un `if ($env === 'test')` dans `services.yaml`.",
        "Créer un fichier `config/test.yaml`.",
        "Ce n'est pas possible."
      ],
      "correct_answers": [
        "Créer un fichier `config/packages/test/framework.yaml`."
      ],
      "explanation": "Symfony charge automatiquement les fichiers de configuration situés dans `config/packages/{env}/`."
    },
    {
      "id": 7,
      "question": "Quel est le moyen recommandé de gérer les secrets (mots de passe, clés API) en production de manière sécurisée ?",
      "type": "single_choice",
      "options": [
        "Les mettre en clair dans `.env`.",
        "Les commiter dans `.env.local`.",
        "Utiliser des variables d'environnement réelles ou le système 'Symfony Secrets' (Vault).",
        "Les écrire en dur dans le code PHP."
      ],
      "correct_answers": [
        "Utiliser des variables d'environnement réelles ou le système 'Symfony Secrets' (Vault)."
      ],
      "explanation": "Les fichiers `.env` ne sont pas faits pour les secrets en production. Symfony Secrets permet de chiffrer ces valeurs."
    },
    {
      "id": 8,
      "question": "À quoi servent les 'processeurs' de variables d'environnement (ex: `file:`, `base64:`) dans un fichier .env ?",
      "type": "single_choice",
      "options": [
        "À exécuter du code PHP.",
        "À transformer la valeur de la variable au moment de son utilisation (ex: lire le contenu d'un fichier, décoder du base64).",
        "À compresser les variables.",
        "À valider le type de la variable."
      ],
      "correct_answers": [
        "À transformer la valeur de la variable au moment de son utilisation (ex: lire le contenu d'un fichier, décoder du base64)."
      ],
      "explanation": "Cela permet par exemple de pointer vers un fichier de secret Docker (`DATABASE_URL=file:/run/secrets/db_password`) et de récupérer son contenu automatiquement."
    }
  ]
}