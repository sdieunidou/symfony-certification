{
  "source_file": "11-cache/http-types.md",
  "title": "Types de Cache HTTP (Gateway vs Proxy)",
  "questions": [
    {
      "id": 1,
      "question": "Quels sont les deux principaux types de cache dans l'architecture HTTP ?",
      "type": "multiple_choice",
      "options": [
        "Le cache Navigateur (Client-side / Privé)",
        "Le cache Base de Données (Redis / Doctrine)",
        "Le Gateway Cache / Reverse Proxy (Partagé / Public)",
        "Le cache CPU (L1 / L2)"
      ],
      "correct_answers": [
        "Le cache Navigateur (Client-side / Privé)",
        "Le Gateway Cache / Reverse Proxy (Partagé / Public)"
      ],
      "explanation": "L'architecture HTTP distingue le cache local du client (privé) et les caches intermédiaires partagés (Gateway/Proxy) qui servent plusieurs utilisateurs."
    },
    {
      "id": 2,
      "question": "Quel type de contenu est candidat pour le cache 'Public' (Gateway Cache) ?",
      "type": "single_choice",
      "options": [
        "Les pages 'Mon Compte' et les Paniers d'achat.",
        "Le contenu générique identique pour tous les utilisateurs (Homepage, Assets, Articles publics).",
        "Les pages d'administration.",
        "Les réponses API contenant des clés secrètes."
      ],
      "correct_answers": [
        "Le contenu générique identique pour tous les utilisateurs (Homepage, Assets, Articles publics)."
      ],
      "explanation": "Le cache public est partagé entre tous les utilisateurs, il ne doit donc contenir aucune donnée personnelle ou sensible."
    },
    {
      "id": 3,
      "question": "Par défaut, comment le standard HTTP considère-t-il une réponse contenant un en-tête `Authorization` ?",
      "type": "single_choice",
      "options": [
        "Comme publique.",
        "Comme privée (non cacheable par un proxy partagé), sauf indication contraire explicite (`public`).",
        "Comme invalide.",
        "Comme ayant une durée de vie illimitée."
      ],
      "correct_answers": [
        "Comme privée (non cacheable par un proxy partagé), sauf indication contraire explicite (`public`)."
      ],
      "explanation": "La présence d'authentification implique généralement un contenu personnalisé, donc le standard HTTP interdit le stockage partagé par défaut."
    },
    {
      "id": 4,
      "question": "Quelle méthode utiliser pour définir la durée de cache spécifique aux proxies partagés (s-maxage) ?",
      "type": "single_choice",
      "options": [
        "`$response->setMaxAge()`",
        "`$response->setSharedMaxAge()`",
        "`$response->setPublicAge()`",
        "`$response->setProxyTTL()`"
      ],
      "correct_answers": [
        "`$response->setSharedMaxAge()`"
      ],
      "explanation": "Cela configure la directive `s-maxage` qui est prioritaire sur `max-age` pour les caches partagés."
    },
    {
      "id": 5,
      "question": "Que se passe-t-il pour le cache partagé si la réponse contient un header `Authorization` ?",
      "type": "single_choice",
      "options": [
        "Elle est considérée comme privée par défaut (non cacheable par les proxies) sauf si `public` est forcé",
        "Elle est automatiquement publique",
        "Elle est ignorée par le navigateur",
        "Elle est chiffrée"
      ],
      "correct_answers": [
        "Elle est considérée comme privée par défaut (non cacheable par les proxies) sauf si `public` est forcé"
      ],
      "explanation": "Standard HTTP pour éviter la mise en cache de contenu authentifié."
    },
    {
      "id": 6,
      "question": "Quel header ajoute Symfony en debug pour tracer le comportement du cache reverse proxy ?",
      "type": "single_choice",
      "options": [
        "`X-Symfony-Cache`",
        "`Cache-Status`",
        "`X-Debug-Cache`",
        "`Cache-Debug`"
      ],
      "correct_answers": [
        "`X-Symfony-Cache`"
      ],
      "explanation": "Il renseigne HIT/MISS/STALE, configurable via trace_level."
    },
    {
      "id": 7,
      "question": "Quelle directive cible uniquement les caches privés (navigateur) et pas les partagés ?",
      "type": "single_choice",
      "options": [
        "`private`",
        "`public`",
        "`s-maxage`",
        "`stale-while-revalidate`"
      ],
      "correct_answers": [
        "`private`"
      ],
      "explanation": "private interdit le stockage par un cache partagé."
    },
    {
      "id": 8,
      "question": "Pourquoi `Vary: Cookie` ruine le cache partagé ?",
      "type": "single_choice",
      "options": [
        "Chaque valeur de cookie crée une variante différente, quasiment une entrée par utilisateur",
        "Il supprime les cookies",
        "Il désactive HTTPS",
        "Il force no-store"
      ],
      "correct_answers": [
        "Chaque valeur de cookie crée une variante différente, quasiment une entrée par utilisateur"
      ],
      "explanation": "On perd le bénéfice du partage entre utilisateurs."
    },
    {
      "id": 9,
      "question": "Quel cache est concerné par `setSharedMaxAge()` ?",
      "type": "single_choice",
      "options": [
        "Les caches partagés (proxies/CDN)",
        "Le cache navigateur uniquement",
        "Aucun, c'est déprécié",
        "Le cache doctrine"
      ],
      "correct_answers": [
        "Les caches partagés (proxies/CDN)"
      ],
      "explanation": "s-maxage est ignoré par le navigateur, utilisé par les reverse proxies."
    },
    {
      "id": 10,
      "question": "Quel type de cache faut-il pour servir une homepage identique à tous avec forte perf ?",
      "type": "single_choice",
      "options": [
        "Cache public partagé (Gateway/Reverse Proxy)",
        "Cache privé",
        "Pas de cache",
        "Cache doctrine"
      ],
      "correct_answers": [
        "Cache public partagé (Gateway/Reverse Proxy)"
      ],
      "explanation": "La homepage générique est un candidat idéal pour un CDN/Varnish/HttpCache."
    }
  ]
}